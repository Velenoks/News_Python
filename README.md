# News Python
<h2>API для новостного портала.</h2>

Данное API разработанно для новостного портала с возможностью регистрации пользователей, просмотра новостей и коментариев к ним. Запросы к API начинаются с <code>/api/v1/</code>. Перед работой обязательно проверь переменные в файле <b>.env.dev</b>.

К проекту по адресу <code>/swagger/</code> подключена документация API. В ней описаны шаблоны запросов к API и структура ожидаемых ответов.

<h2>Развертывание окружения</h2>

Обязательно, перед рабой с docker, проверьте переменные окружения в файле <b>.env.dev</b>

Для начала необходимо выполнить команду <code>docker-compose build</code>, произойдет сборка проекта.
Затем нужно запустить проект командой <code>docker-compose up</code>.
Все, можете пользоваться приложением.

<h2>Создание Администратора</h2>

Приложение имеет возможность создавать администратора запуском команды<code>python manage.py initadmin</code>. Команда применяется при запуске проекта.

Дефолтные значения <code>username=admin</code>, <code>email=admin@newspy.com</code> и <code>password=admin</code>, если они не прописаны в <b>.env</b> файле.

Так же любой Администратор может назначить любого пользователя Администратором.

<h2>Установленные пакеты</h2>

1. Requests - HTTP-библиотека для Python
2. Django - WEB-фреймворк для Python
3. Django Rest Framework - фреймворк для создания API
4. Django-filter - приложение для фильтрации 
5. Djangorestframework-simplejwt - плагин аутентификации JSON Web Token для Django Rest Framework
6. Django-mptt - приложение для работы с mptt для Django
7. Django-debug-toolbar - панель иснтрументов для отладки приложений Django
8. Django Extensions - это набор настраиваемых расширений для Django Framework (использовалось для shell_plus)
9. Pillow - библиотека для работы с изображениями для Python
10. psycopg2 - драйвер для базы данных PostgreSQL
11. Django-cors-headers - приложение добавляющее заголовки CORS
12. drf-yasg - приложение для создания документации

<h2>Алгоритм регистрации пользователей</h2>

1. Пользователь отправляет запрос с параметром <code>email</code>, <code>username</code>, <code>password</code>, <code>password_check</code> на <code>/auth/email/</code>.

2. Приложение отправляет письмо с кодом подтверждения <code>confirmation_code</code> на адрес <b>email</b>.

3. Пользователь отправляет запрос с параметрами <code>email</code> и <code>confirmation_code</code> на <code>/auth/token/</code>, в ответе на запрос ему приходит token (JWT-токен).
Пока пользователь не подтвердит регистрацию через <b>confirmation_code</b>, он не сможет пользоваться ресурсом.

4. При желании пользователь отправляет PATCH-запрос на <code>/users/me/username</code> и заполняет поля в своём профайле (описание полей — в документации).

<h2>Пользовательские роли</h2>

<b>Аноним</b> — может просматривать новости, но невидит и не может оставлять комментарии.

<b>Аутентифицированный пользователь</b> — может читать новости, может читать и оставлять коментарии, комментировать чужие коментарии, может редактировать и удалять <b>свои</b> комментарии.

<b>Заблокированный пользователь</b> — те же права, что и у <b>Аутентифицированного пользователя</b>, но отсуствует возможность писать и редактировать комментарии.

<b>Администратор</b> — полные права на управление проектом и всем его содержимым. Может создавать и удалять новости и комментарии. Может назначать роли пользователям.
